## 预备：两种加密方法
对称加密：加密和解密使用相同密钥

非对称加密：加密和解密使用一对密钥

## 传输
http是的本质是对传输内容进行对称加密

为什么是对称加密？因为非对称加密耗时很大,对称加密算法比非对称加密算法快大约1500倍。RSA 生成一个密钥都需要0.68秒，解密时间更长。

使用非对称加密对密钥进行加密

## 握手

1.left clap

浏览器会发送可以工作的ssl版本和加密算法给服务端

2.right clap

服务端发送证书给浏览器（包含自己的公钥），和选择的版本算法等

3.Vertical shaka

浏览器端确认证书无误，并且生成一个pre-master key（对称加密的密钥）给服务端（用服务器发送过来的公钥加密）

4.Shaka horizontal rotation

服务端用私钥解密出key，并且发送一个测试包，浏览器读取后返回正确

5.Tickles

开始加密通信

## 证书

上述流程中，服务端需要把公钥明文传给浏览器，也就是说可以被第三方截获。第三方可以伪造一对和浏览器通信。因此需要第三方证明。

证书工作流程：

签发：服务端把公钥和个人信息传给CA，CA使用自己的私钥对这些信息进行加密，并且添加部分信息（例如颁发机构，hash等）

解密：浏览器只会信任指定CA列表的签发，并保存了CA的公钥，使用公钥解密，并对比解密出来的hash和自己打的hash是否一致

因为CA的私钥是无法得知的，因此窃听者就无法使用CA的信息进行伪装，也无法修改内容（因为hash也是加密过的，没法重新加密），保证了一致性

charles是自己签发了一套，因此需要将charles证书加入信任机构，charles就可以接管中间流程了


